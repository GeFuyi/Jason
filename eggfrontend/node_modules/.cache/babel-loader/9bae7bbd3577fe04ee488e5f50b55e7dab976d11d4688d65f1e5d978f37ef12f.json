{"ast":null,"code":"import { Client } from '@stomp/stompjs';\nimport SockJS from 'sockjs-client';\nlet stompClient = null;\nexport function connect(userId, onMessageReceived) {\n  const socket = new SockJS('http://localhost:8080/ws-chat');\n  stompClient = new Client({\n    webSocketFactory: () => socket,\n    debug: function (str) {\n      console.log(str);\n    }\n  });\n  stompClient.onConnect = () => {\n    // 群聊\n    stompClient.subscribe('/topic/group', msg => onMessageReceived(JSON.parse(msg.body)));\n    // 私聊\n    stompClient.subscribe(`/user/${userId}/queue/private`, msg => onMessageReceived(JSON.parse(msg.body)));\n  };\n  stompClient.activate();\n}\nexport function sendMessage(fromUserId, toUserId, content) {\n  stompClient.publish({\n    destination: '/app/chat.send',\n    body: JSON.stringify({\n      fromUserId,\n      toUserId,\n      content\n    })\n  });\n}","map":{"version":3,"names":["Client","SockJS","stompClient","connect","userId","onMessageReceived","socket","webSocketFactory","debug","str","console","log","onConnect","subscribe","msg","JSON","parse","body","activate","sendMessage","fromUserId","toUserId","content","publish","destination","stringify"],"sources":["D:/Final/springboot_egg/egg-web/src/utils/chat.js"],"sourcesContent":["import { Client } from '@stomp/stompjs'\r\nimport SockJS from 'sockjs-client'\r\n\r\nlet stompClient = null\r\n\r\nexport function connect(userId, onMessageReceived) {\r\n    const socket = new SockJS('http://localhost:8080/ws-chat')\r\n    stompClient = new Client({\r\n        webSocketFactory: () => socket,\r\n        debug: function(str) { console.log(str) }\r\n    })\r\n    stompClient.onConnect = () => {\r\n        // 群聊\r\n        stompClient.subscribe('/topic/group', msg => onMessageReceived(JSON.parse(msg.body)))\r\n        // 私聊\r\n        stompClient.subscribe(`/user/${userId}/queue/private`, msg => onMessageReceived(JSON.parse(msg.body)))\r\n    }\r\n    stompClient.activate()\r\n}\r\n\r\nexport function sendMessage(fromUserId, toUserId, content) {\r\n    stompClient.publish({\r\n        destination: '/app/chat.send',\r\n        body: JSON.stringify({ fromUserId, toUserId, content })\r\n    })\r\n}\r\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,gBAAgB;AACvC,OAAOC,MAAM,MAAM,eAAe;AAElC,IAAIC,WAAW,GAAG,IAAI;AAEtB,OAAO,SAASC,OAAOA,CAACC,MAAM,EAAEC,iBAAiB,EAAE;EAC/C,MAAMC,MAAM,GAAG,IAAIL,MAAM,CAAC,+BAA+B,CAAC;EAC1DC,WAAW,GAAG,IAAIF,MAAM,CAAC;IACrBO,gBAAgB,EAAEA,CAAA,KAAMD,MAAM;IAC9BE,KAAK,EAAE,SAAAA,CAASC,GAAG,EAAE;MAAEC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;IAAC;EAC5C,CAAC,CAAC;EACFP,WAAW,CAACU,SAAS,GAAG,MAAM;IAC1B;IACAV,WAAW,CAACW,SAAS,CAAC,cAAc,EAAEC,GAAG,IAAIT,iBAAiB,CAACU,IAAI,CAACC,KAAK,CAACF,GAAG,CAACG,IAAI,CAAC,CAAC,CAAC;IACrF;IACAf,WAAW,CAACW,SAAS,CAAC,SAAST,MAAM,gBAAgB,EAAEU,GAAG,IAAIT,iBAAiB,CAACU,IAAI,CAACC,KAAK,CAACF,GAAG,CAACG,IAAI,CAAC,CAAC,CAAC;EAC1G,CAAC;EACDf,WAAW,CAACgB,QAAQ,CAAC,CAAC;AAC1B;AAEA,OAAO,SAASC,WAAWA,CAACC,UAAU,EAAEC,QAAQ,EAAEC,OAAO,EAAE;EACvDpB,WAAW,CAACqB,OAAO,CAAC;IAChBC,WAAW,EAAE,gBAAgB;IAC7BP,IAAI,EAAEF,IAAI,CAACU,SAAS,CAAC;MAAEL,UAAU;MAAEC,QAAQ;MAAEC;IAAQ,CAAC;EAC1D,CAAC,CAAC;AACN","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}